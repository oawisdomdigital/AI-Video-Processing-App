{"ast":null,"code":"import React,{useState}from\"react\";import axios from\"axios\";import{ToastContainer,toast}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";import\"./App.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[video,setVideo]=useState(null);const[processedVideo,setProcessedVideo]=useState(null);const[loading,setLoading]=useState(false);const[progress,setProgress]=useState(0);const[cancelTokenSource,setCancelTokenSource]=useState(null);const handleFileChange=e=>{setVideo(e.target.files[0]);};const handleUpload=async()=>{if(!video){toast.error(\"Please upload a video!\");return;}const formData=new FormData();formData.append(\"file\",video);setLoading(true);setProgress(0);const source=axios.CancelToken.source();setCancelTokenSource(source);try{const response=await axios.post(\"http://127.0.0.1:8000/upload/\",formData,{headers:{\"Content-Type\":\"multipart/form-data\"},cancelToken:source.token});toast.success(\"Video uploaded successfully! Processing started.\");const videoId=response.data.id;// Start polling\npollProcessingStatus(videoId);}catch(error){if(axios.isCancel(error)){toast.info(\"Upload canceled.\");}else{var _error$response;toast.error(\"Error uploading video!\");console.error(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);}setLoading(false);}};const pollProcessingStatus=async videoId=>{try{const response=await axios.get(\"http://127.0.0.1:8000/status/\".concat(videoId,\"/\"));const{progress,video_url,status}=response.data;setProgress(progress);if(status===\"completed\"){toast.success(\"Processing completed!\");setProcessedVideo(video_url);setLoading(false);}else if(status===\"failed\"){toast.error(\"Processing failed!\");setLoading(false);}else{setTimeout(()=>pollProcessingStatus(videoId),3000);}}catch(error){toast.error(\"Error fetching processing status.\");setLoading(false);}};const handleCancel=()=>{if(cancelTokenSource){cancelTokenSource.cancel(\"Upload canceled by the user.\");setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Video Editor\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleFileChange,accept:\"video/*\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleUpload,disabled:loading,children:loading?\"Processing...\":\"Upload and Process\"}),loading&&/*#__PURE__*/_jsx(\"button\",{onClick:handleCancel,children:\"Cancel\"}),loading&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Progress: \",progress,\"%\"]}),/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\",background:\"#ddd\",height:\"20px\"},children:/*#__PURE__*/_jsx(\"div\",{style:{width:\"\".concat(progress,\"%\"),background:\"green\",height:\"100%\"}})})]}),processedVideo&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Processed Video\"}),/*#__PURE__*/_jsx(\"video\",{src:\"http://127.0.0.1:8000\".concat(processedVideo),controls:true})]}),/*#__PURE__*/_jsx(ToastContainer,{})]});};export default App;","map":{"version":3,"names":["React","useState","axios","ToastContainer","toast","jsx","_jsx","jsxs","_jsxs","App","video","setVideo","processedVideo","setProcessedVideo","loading","setLoading","progress","setProgress","cancelTokenSource","setCancelTokenSource","handleFileChange","e","target","files","handleUpload","error","formData","FormData","append","source","CancelToken","response","post","headers","cancelToken","token","success","videoId","data","id","pollProcessingStatus","isCancel","info","_error$response","console","message","get","concat","video_url","status","setTimeout","handleCancel","cancel","children","type","onChange","accept","onClick","disabled","style","width","background","height","src","controls"],"sources":["C:/Users/USER/Desktop/video_editor/video-editor-frontend/src/App.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { ToastContainer, toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport \"./App.css\";\n\nconst App = () => {\n  const [video, setVideo] = useState(null);\n  const [processedVideo, setProcessedVideo] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [cancelTokenSource, setCancelTokenSource] = useState(null);\n\n  const handleFileChange = (e) => {\n    setVideo(e.target.files[0]);\n  };\n\n  const handleUpload = async () => {\n    if (!video) {\n      toast.error(\"Please upload a video!\");\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append(\"file\", video);\n\n    setLoading(true);\n    setProgress(0);\n\n    const source = axios.CancelToken.source();\n    setCancelTokenSource(source);\n\n    try {\n      const response = await axios.post(\"http://127.0.0.1:8000/upload/\", formData, {\n        headers: { \"Content-Type\": \"multipart/form-data\" },\n        cancelToken: source.token,\n      });\n\n      toast.success(\"Video uploaded successfully! Processing started.\");\n      const videoId = response.data.id;\n\n      // Start polling\n      pollProcessingStatus(videoId);\n    } catch (error) {\n      if (axios.isCancel(error)) {\n        toast.info(\"Upload canceled.\");\n      } else {\n        toast.error(\"Error uploading video!\");\n        console.error(error.response?.data || error.message);\n      }\n      setLoading(false);\n    }\n  };\n\n  const pollProcessingStatus = async (videoId) => {\n    try {\n      const response = await axios.get(`http://127.0.0.1:8000/status/${videoId}/`);\n      const { progress, video_url, status } = response.data;\n\n      setProgress(progress);\n\n      if (status === \"completed\") {\n        toast.success(\"Processing completed!\");\n        setProcessedVideo(video_url);\n        setLoading(false);\n      } else if (status === \"failed\") {\n        toast.error(\"Processing failed!\");\n        setLoading(false);\n      } else {\n        setTimeout(() => pollProcessingStatus(videoId), 3000);\n      }\n    } catch (error) {\n      toast.error(\"Error fetching processing status.\");\n      setLoading(false);\n    }\n  };\n\n  const handleCancel = () => {\n    if (cancelTokenSource) {\n      cancelTokenSource.cancel(\"Upload canceled by the user.\");\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div>\n      <h1>Video Editor</h1>\n      <input type=\"file\" onChange={handleFileChange} accept=\"video/*\" />\n      <button onClick={handleUpload} disabled={loading}>\n        {loading ? \"Processing...\" : \"Upload and Process\"}\n      </button>\n      {loading && <button onClick={handleCancel}>Cancel</button>}\n      {loading && (\n        <div>\n          <p>Progress: {progress}%</p>\n          <div style={{ width: \"100%\", background: \"#ddd\", height: \"20px\" }}>\n            <div style={{ width: `${progress}%`, background: \"green\", height: \"100%\" }}></div>\n          </div>\n        </div>\n      )}\n      {processedVideo && (\n        <div>\n          <h2>Processed Video</h2>\n          <video src={`http://127.0.0.1:8000${processedVideo}`} controls />\n        </div>\n      )}\n      <ToastContainer />\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}